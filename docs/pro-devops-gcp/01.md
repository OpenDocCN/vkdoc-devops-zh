# 一、DevOps 简介

DevOps，DevOps，DevOps，在我们的职业生涯中，几乎没有一天不听到这句口头禅。原因很简单:通过采用 DevOps 实践，一个公司可以减少“上市时间”，即识别一个新软件或其他需求并将其放置到位所必需的时间。

在这一章中，我介绍了 DevOps 的一些优点，以及为了适应和促进公司最大限度地利用它们而必须做出的改变。

## DevOps 是什么？

术语 *DevOps* 来源于两个词的组合:*开发者*和*运营*。 *DevOps* 用来定义一场运动，这场运动源于减少公司开发和运营团队之间障碍的需要。DevOps 的目标是缩短上市时间。这意味着采用 DevOps 实践，以减少所需的时间，从识别新需求到为客户投入使用的时间。DevOps 之旅引入了持续集成和持续交付等实践，这些实践有助于缩短上市时间并生产更高质量的软件。

与新版本相关的最重大、可能也是最昂贵的失败发生在 2012 年，当时全球金融服务公司骑士资本集团(Knight Capital Group)因其服务器在发布过程中出现故障而损失了 4 . 4 亿美元；2013 年，高盛(Goldman Sachs)的一次升级失败意外发送了订单，导致据信高达数百万美元的损失。DevOps 允许一组实践，可以减少潜在的昂贵错误。

当我们想到 DevOps 时，我们必须想到一场改变整个公司合作方式的运动。目标是建立一套实践，用于减少公司不同部门之间的沟通障碍。为了取得成功，DevOps 应该在公司的最高层得到提升，并被每个部门所接受。

DevOps 背后的理念诞生于 2008 年，在加拿大多伦多的敏捷大会上。在这次会议上，Patrick Debois 发表了他的演讲“基础设施和运营”在这篇文章中，Debois 阐述了敏捷方法在构建基础设施中的应用。他提供了三个案例研究，并在最后提出了一种更好的交流方法和其他改进，允许开发人员获得更多的 IT 技能，这是确保更平稳的发布过程所必需的系统知识。

这场运动一直在发展，直到 2014 年《凤凰计划》一书的出版。在本书中，作者 Gene Kim、Kevin Behr 和 George Spafford 描述了如何使用 DevOps 创建成功的企业。凭借这本书，DevOps 运动的开始变得正式，之后，随着 DevOps 工程师的出现，一个新的 IT 人物诞生了。

## DevOps 工程师

DevOps 工程师的角色是最近才出现的。DevOps 工程师代表了开发人员和运营经理之间的一种桥梁。在大多数情况下，DevOps 工程师承担的角色是运营经理和开发人员的混合，这很好，因为这些工程师必须具备建议和管理来自这两个领域的问题的必要知识。

在某些情况下，DevOps 工程师的职责与持续集成和交付有关。与该职位相关的另一项职责是基础设施管理，通常是基础设施即代码(IaC ),并帮助在整个公司实施最佳开发运维实践。

一些公司将 DevOps 工程师视为站点可靠性工程师(SRE)的演变，其主要职责是在生产中维护软件，并在出现问题时自动执行所有步骤来解决问题，并采取适当的步骤来确保维护系统所需任务的正常管理。开发运维工程师的角色各不相同，可能会因公司而异，但他们的核心都是确保实施公司发起的开发运维实践所需的变更。

## 采用 DevOps

在一家公司采用 DevOps 就像开始了一段新的旅程。在这个过程中，管理必须有效，变革才能成功。下面的列表强调了旅程的重要路标。

*   经理必须推动变革。

*   开发者必须对软件负责。

*   操作人员必须被视为“一等公民”

*   必须建立持续集成和持续交付策略。

*   必须消除 IT 部门的障碍。

*   发布过程必须自动化。

*   敏捷实践必须在整个公司推广。

要达到预期的结果，需要管理层发起开发运维变革，并将其融入公司文化。

这一步对于确保 DevOps 之旅的成功非常重要，当然，为了真正有效，还需要一些技术上的改变。让我们详细研究一下这意味着什么。

### 经理必须推动变革

要想成功，开发运维所需的变更必须首先被管理层推动和接受。为了使变革有效，它必须得到公司的大力支持。

例如，想象一下，在我们旅程的开始，我们开始了一个新的发展。我们想设计一个持续集成/持续交付(CI/CD)系统。为了做到这一点，我们决定采用 Scrum 作为我们的方法，而不是以前使用的瀑布。

有一天，首席技术官(CTO)提出了一个他/她绝对想在春天发布的新功能，只有几个月的时间，但要做到这一点，我们必须取消和推迟一些其他功能。Scrum Master 试图告诉 CTO 不要这么快引入新特性，因为这会延迟其他特性并导致一些问题。首席技术官坚持，并利用他/她的权力，推动该功能的春天。为了赶上这个日期，团队必须推迟一些其他的工作，更快地开发新的功能，从而产生一些软件质量问题。需求并不完全清晰，在 CI/CD 中，周期问题被识别出来，这使得软件质量很差，基本上没有准备好发布。

最终，团队对 DevOps 实践失去了信心，渐渐地，每个人都回到了通常的做事方式。

### 开发者必须对软件负责

在正常的开发周期中，当软件发布到实际生产时，开发团队的责任就结束了。之后，开发人员开发新的功能，只有在运营部门发现需要修复的错误时才会参与进来。但这意味着必须发布新的特性，运营团队必须找到一种方法来减少 bug。

如果我们想要有一个成功的 DevOps 之旅，我们必须授权给开发者。这意味着当运营团队发现软件中的错误时，从事该功能的开发人员必须参与修复。这有两个主要优点:

*   开发人员可以更容易地识别问题并找到解决问题的方法。因为他/她了解软件，所以他/她更容易找到问题的根本原因。

*   因为开发人员可以确定问题的根本原因，所以他/她更容易找到永久的解决方案。这与 CI/CD 实践相结合，减少了发布的上市时间，并提高了软件的质量和稳定性。

这需要公司文化的重大变革:为 DevOps 的另一个重要变革铺平道路，当然，这必须得到管理层的完全批准才能真正有效。最大的好处是这保证了软件质量的提高。

### 操作人员必须被视为“一等公民”

当我们设计一个新特性时，开发和架构团队必须和操作团队一起参与。这是因为负责实时软件正确运行的人员组成了运营团队。

在一个新特性的发布中，操作人员在架构决策过程中的角色尤其重要。例如，想象一下，我们必须为我们的系统设计一个新的特性。开发人员为 web 界面提出了一个奇特的新组件，并提供了一个迷你演示。当然，在开发人员的笔记本电脑上，不会出现任何问题。但是，当在实际的服务器上测试组件时，可能会出现问题。唯一能够有效应对此类问题的人是操作技术人员，他们知道应该在哪个服务器上安装和运行软件，并且知道与安全性、软件版本等相关的所有策略。在这种情况下，运营团队可以拒绝该组件，例如，因为它不符合公司标准，或者团队可以启动一个流程来测试服务器并为新组件做好准备。

这意味着，对于下一个 n-Sprint 阶段的这个 Sprint，组件不能被使用，但是当服务器准备好时，操作团队可以通知开发团队。让操作团队参与软件设计的另一个重要原因是日志级别。对于一个开发人员来说，信息可能很清楚，但这是因为他/她了解软件并理解正在发生的事情。操作人员必须能够主要通过阅读日志来了解问题。如果日志过于冗长或不清楚，这将妨碍对错误的正确分析，并导致在寻找解决方案和确定问题的根本原因方面的延迟。

### 必须建立持续集成和持续交付策略

使用 CI/CD 策略有助于开发和运营团队更快地发现软件的潜在问题。当我们建立 CI/CD 实践时，我们会不断收到反馈。每个 CI/CD 系统的一个重要部分是代码审查。当开发人员完成代码时，必须对其进行全面测试。首先，为了确保成功的集成，开发人员必须要求其他软件工程师审查代码，并提出在代码中发现的任何问题。对于 CI/CD 系统来说，这是一个非常重要的步骤。对于软件中的每个简单更新，开发人员必须开始采用测试驱动开发(TDD)实践。这样，每个提交都可以由 CI 软件(例如 Jenkins)进行全面测试，并提升到下一步，例如创建和交付到质量保证(QA)环境进行测试。

建立 CI/CD 系统有助于提高系统的质量和稳定性。其原因与系统的性质有关。每当我们向它提交一个新文件时，软件的整个生命周期就延长了。这意味着，在出现新的错误时，我们可以实时确定错误的原因，并且我们可以轻松地回滚软件交付。同时，我们获得了不断审查软件的能力。这有助于运营团队识别安全风险，并采取所有必要的措施来消除这些风险。

但是为了获得真正的成功，避免产生问题和破坏系统的稳定，软件工程师必须在单元测试和自动化测试上投入更多的时间。此外，我们必须在代码审查上投入时间。如果我们没有一个好的软件测试覆盖率，或者没有真正审查代码，我们可能会发布具有潜在危险的软件，并危及应用的安全性。

### 必须消除 IT 部门的障碍

通常，开发和运营团队在日常工作中使用不同的软件。如果我们想确保有效的 DevOps 之旅，这可能会造成必须消除的障碍。

DevOps 可以统一沟通工具，促进不同 IT 相关部门之间的沟通。通过这种方式，我们可以协调软件发布的时间框架，并且可以更好地计划所涉及的工作。例如，如果引入到 CI 系统中的新特性产生了安全缺陷，安全团队可以使用公共通道与开发团队进行沟通，这样就可以找到解决问题的方法。同时，操作团队可以被告知开发人员对软件所采取的每一个步骤，并且可以为发布做好准备。

### 发布过程必须自动化

通过分析错误率，我们可以明确地将人为因素确定为失败的主要原因。DevOps 的主要重点是减少人为和其他错误，并缩短上市时间。为了实现这一点，我们必须做的一个重要的改变是自动化发布过程。

通过发布软件的自动化过程，我们减少了人与系统的交互。更少的人工干预减少了失败的数量，因为我们有一个可预测和可重复的过程。

具有自动过程的另一个优点是定义 IaC 的可能性。有了 IaC，我们可以通过代码定义我们的软件需要什么类型的结构。此外，定义 IaC 使基础设施可预测，并允许更快地发布升级。在最好的情况下，自动化发布过程和定义基础设施减少或消除了人工交互，因此，有效地减少了错误率。

### 敏捷实践必须在整个公司推广

DevOps 诞生于一次敏捷会议期间，为了提高效率，公司必须开始在所有部门实施敏捷。通常，敏捷实践主要由开发团队使用，但是为了一个好的 DevOps 之旅，我们必须将这种实践也推广到基础设施和运营团队。如果整个团队都在 Sprint 中工作，如果可能的话，共享相同的 backlog，这将有助于改善沟通。在 Sprint 计划期间，其他团队可以调整工作，以使其更有效。

同时，有了敏捷，我们可以改善沟通，让工作在团队中更加明显。在冲刺阶段的最后，我们可以看到其他团队的工作演示。这有助于了解工作的有效性，以及如何改进从一个团队到另一个团队的迭代。

## 采用 DevOps 的原因

公司决定采用 DevOps 有不同的原因。通常，DevOps 理念的采用与软件质量的改进和管理其发布的更好的方法有关。

当一个公司采用 DevOps 时，第一步是改善跨团队的交流。DevOps 的这一特点是敏捷方法所共有的，只有在整个公司使用的工具协调一致的情况下才能实现。

这种变化并不总是容易被所有 IT 员工接受。最初的抵制通常是对采用 DevOps 所必需的文化的改变。通常，设计和实现基础设施的生命周期是使用 ITIL 来管理的。这意味着该过程遵循瀑布方法，因为如果服务器不在您手中，配置服务器基本上是不可能的。

采用 DevOps 意味着改变我们对基础设施的看法:在可能的情况下，将其迁移到云，采用基础设施作为代码，并采用案例的兼容性，使用 Sprint 来管理工作。这要求所有团队使用共同的项目方法，并创建与开发团队共享的共同产品 backlog，特别是当项目涉及新的基础设施时。

采用 DevOps 实践的另一个原因是发布的软件质量的提高。有了 DevOps，我们可以采用一些程序来提高软件的质量。为此，我们必须实施持续集成和持续交付。有了这些，当我们在存储库上推送代码时，很容易识别错误。此外，因为我们有连续交付，我们可以每天更多次在 QA 上直接发布软件。这确保了对软件的持续检查和对软件工程师的持续反馈。

这些只是推动 DevOps 之旅的一些常见原因。不管是什么原因，了解 DevOps 中涉及哪些角色是很重要的。为此，我们必须澄清一些通常与 DevOps 的使用有关的误解。在这一点上，我们必须尝试识别与 DevOps 相关的常见错误，并澄清其角色和涉及的人员。

### DevOps 涉及哪些内容和人员？

在谈论 DevOps 时，我们可能会对它是什么以及谁参与其中产生一些误解。关于采用 DevOps 的第一个神话与处理它的专业人员有关。对于许多人来说，DevOps 只涉及软件工程师、系统工程师和系统管理员。

这种假设是不正确的。当一个公司决定采用 DevOps 时，首先需要做的改变是改善不同团队之间的沟通。这不仅意味着开发和运营，还意味着其他团队，如 QA、安全和业务团队。为了有效和成功，DevOps 之旅需要所有团队成员共同努力。DevOps 的目标是缩短上市时间。这意味着当一个新的特性被设计出来时，每个团队都必须进行沟通，以达到目标。QA 工程师必须对软件工程团队做出快速反应，并传达软件中发现的任何小故障。同时，软件工程师必须与安全团队沟通，描述软件做什么和使用什么库，并允许安全团队管理必要的资产以确保软件的安全性。业务分析师必须与软件架构师保持一致，软件工程师必须与客户的需求保持一致。

如您所见，要进行成功的开发运维之旅，整个组织都应该参与进来。每个团队都必须负责一小部分业务，但是要与其他团队合作。DevOps 寻求消除团队之间的沟通障碍，使在开发期间而不是在发布后识别和纠正错误变得更加容易。这确保了更好的软件，更及时地发布到市场，更好地符合客户的需求。

所有这些演员必须像管弦乐队中的音乐家一样一起工作。如果所有人都尊重交响乐，一切都很顺利，但如果一个团队开始出现问题或没有练习良好的沟通，预定的目标就会打折扣。由于这个原因，采用 DevOps 时最重要的工作是改善内部和外部团队的协调。

### 改变坐标

通过采用 DevOps，我们想要实现的目标之一是减少协调性。这意味着确保那些负责管理团队的人投入更少的时间来协调不同的操作。当将软件从开发服务器转移到 stage 服务器时，这变得非常重要。如果有 CI/CD 业务，软件会自动升级。

当更多的自动化过程被引入时，人与人之间的相互作用减少了，因此对协调的要求也减少了。这对于缩短上市时间是必要的。更少的人需要认可；因此，出现的延迟更少。这需要改变传统的协调过程。当我们采用非自动化的过程时，通常，当我们完成软件开发时，负责开发的团队传达开发的完成，然后与其他负责的团队协调，将软件移到前台。这种协调本质上是将不同的交流方式委托给人类，例如通过电子邮件。DevOps 试图改变这种协调方式，减少人类的互动，当然，也改变了协调的实现方式。

协调有不同的实现方式。这些变化取决于环境——团队是远程的、现场的还是部分远程的。良好协调所需的正常属性是

*   直接的

*   间接的

*   坚持的

这三个属性定义了我们如何管理整个团队的协调。每种风格都有它的优点和缺点，所以我们必须确保使用正确的协调类型来达到我们的目的。错误的类型会导致不必要的资源消耗和不良的协调。我现在将讨论不同的风格以及何时使用一种而不是另一种。我将描述如何使用敏捷，提高协调性，并在敏捷方法的角色和工件之间进行划分。

各种协调的目标是改善沟通，从而缩短上市时间。记住:DevOps 的最终目标是缩短上市时间。

#### 直接协调

通过直接协调，那些负责协调的人互相认识。这意味着协调员直接协调每个团队成员的工作。这种协调需要那些负责协调的人做大量的工作。通常，当使用 Scrum 管理团队时，这种努力可以减轻。这样，在站立期间，负责协调的工作人员可以接收关于团队状态的直接反馈，并就此做出决定。

#### 间接协调

通过这种类型的协调，我们不只是协调人，我们协调一个团队，例如，系统管理，软件工程，等等。这种协调需要更大的协调，因为我们并不真正深入任务的细节，而是从更高的层次接近它。例如，想象一下，我们必须管理正在安装的新软件、新的基础设施和新的软件功能。我们想要的协调不是关于详细的任务，而是对某个特定任务状态的总体看法。这个视图给予协调者制定计划的能力，并开始转移到其他活动上来计算发布的估计时间。

这种计划通常委托给产品负责人。仍然保持 Scrum 风格的管理，产品负责人并不真正深入单个功能，但是他/她有一个全局观点。生产负责人负责整个项目，当然，可以帮助团队达到最佳结果，减少不必要的工作。

#### 持续协调

这实际上不是一种协调，而是一种人工制品。持续协调指的是当一个项目做出决定时，所有的报告和电子邮件都会被发送出去。

坚持给团队所有的工具来保持产品故事的每日记录，并允许团队基于项目的历史做出新的决策，并防止对项目本身的任何误解。

### DevOps 链

到目前为止，我只讨论了可用的协调类型，以及哪些类型可以用来改善沟通。然而，我们想回答的最重要的问题是，为什么协调在 DevOps 中如此重要。

原因很简单。DevOps 运动按照“工具链”进行本质上，该工具链用于定义生产过程的每一步。

图 [1-1](#Fig1) 显示了软件版本开发的各个阶段。每个阶段都可以由不同的团队管理。因此，强有力和明确的协调和沟通非常重要。

![../images/464715_1_En_1_Chapter/464715_1_En_1_Fig1_HTML.jpg](../images/464715_1_En_1_Chapter/464715_1_En_1_Fig1_HTML.jpg)

图 1-1

波特的 DevOps 价值链

为了更好地理解协调和沟通的重要性，我们必须理解每个阶段是如何连接到其他阶段的，从而为软件创建一个生产“链”。

第一阶段是*代码*。在此阶段，创建软件代码。每个开发人员都将代码放在一个公共的存储库中，例如 Git，这将导致链中的下一个环节。

第二阶段是*建造*。这个阶段与持续集成实践直接相关。先前提交的代码被下载到构建服务器中，然后以自动方式构建。同时，第一次进行测试。如果测试的所有要素都成功，下一阶段就开始了。

第三个阶段是*测试*阶段。以前构建的软件通过一些自动过程进行测试，但是这一次，软件被一起测试。在构建阶段，只执行与我们发布的特定功能相关的单元测试。如果系统没有发现任何问题，软件将被提升到下一个阶段。如果失败，软件将被拒绝，一个自动系统将通知开发者。

第四阶段是*配置*。这个阶段需要明确的区分。当我们有好的和经过测试的 DevOps 实践时，我们可以有连续的发布。显然，这意味着软件在产品中的持续发布。然而，对于任务关键的软件，这个阶段通常分为两个不同的部分。第一个版本是为数量有限的服务器设计的，叫做*金丝雀服务器*。

### 注意

术语 *canary server* 指的是有意限制的用于测试新软件的服务器数量。canary 服务器的目的是允许真实用户使用新软件，并提供关于潜在错误和服务器质量的实时反馈。当我们希望确保不发布对公司有潜在破坏性的软件时，canary 服务器非常重要。同时，canary 软件可用于笔测试和提高系统安全性。

该链的第五阶段是*释放*。在这个阶段，配置服务器以及新软件的基础设施。这个阶段定义了 IaC。使用代码创建和管理服务器。Chef、Puppet、Ansible 和 CloudFormation 等软件都是创建 IaC 的软件示例。

### 注意

基础设施即代码(IaC)是 DevOps 的核心。IaC 提供了为新服务器创建基础结构的能力。这保证了每一个新发布的完整性，因为减少了人的交互，提高了发布的完整性。此外，IaC 允许 DevOps 根据请求创建不同的环境。这使得开发人员可以根据请求直接创建不同的环境和不同的测试环境。有了 IaC，我们可以创建并编排一个*不可变的基础设施*，也就是说，一个由一些不可变的组件组成的基础设施，这些组件在我们每次发布基础设施时都会被替换。我们可以简单地用必要的更新部署一个新的不可变组件，而不是为我们的基础设施更新一个组件。这保证了整个基础设施的稳定性，并确保基础设施在每次发布时总是产生相同的结果。

该链的第六阶段是*监视器*。这对于提供关于我们的软件和基础设施的持续反馈是极其重要的。在 DevOps 中，监控是非常重要的，因为它允许开发人员获得关于软件的反馈，包括失败的平均值、失败的种类等等。，同时可用于检查服务器的指标，并为自动缩放提供反馈。

协调和沟通对于建立完整的 DevOps 链至关重要。这是因为每个阶段的每一步都需要很好的协调。我们必须确保每一步都有可靠的反馈，因为我们必须对错误做出快速反应并调整系统，以防止新的错误。

## 定义开发流水线

为了确保 DevOps 之旅的成功，最重要的工作之一就是定义开发流水线。构建这个流水线本质上是 DevOps 所要求的变化的核心。

开发生命周期中的第一个变化是实施持续集成。这需要对我们的开发实践进行一些更改，这些更改可以总结如下:

*   定义单元测试。

*   定义分支策略。

*   建立一个持续的集成系统。

这三个实践是开发流水线的主干。首先，*单元测试*发生在开发人员每次将代码提交到中央存储库的时候。

当代码被提交给软件进行持续集成时——例如 Jenkins——这将编译代码并执行与软件相关的单元测试。在失败的情况下，一封带有测试结果的电子邮件被发送给开发人员。

因为我们不想破坏主分支，所以我们采用第二种做法，即*分支策略*。这对保持一个干净的主分支很重要。当开发团队采用这种策略时，每个开发人员在开发一个特性时都会创建一个特定的分支。该策略与代码审查密切相关。对于每次与主版本的合并，在构建完成并正确测试之后，都会进行代码审查。本质上，对于每次提交，只构建分支。这样，在出现错误的情况下，母版不会被破坏，并且总是准备好释放。

在积极构建的情况下，我们可以要求进行代码审查，当代码审查完成时，将分支与主分支合并，当然，重新启动一个完整的系统进行*持续集成*。有了持续集成，我们每次提交到主节点或分支时都要进行构建和测试。

持续集成必须与良好的通信系统相匹配。特别是，我们必须有一个良好的邮件系统，向开发者发送电子邮件，以中断流水线中的连续性。

有了这条流水线，我们就有了持续的软件生产。关闭流水线的是发布和监控。

在开发生命周期中，发布不是在生产过程中进行，而是在 QA 和测试服务器时进行。这种释放是自动发生的。本质上，它是对持续集成系统构建的软件的提升。QA 工程师将此版本用于测试目的，以测试软件，向开发人员提供更快的反馈，并更快地修复任何错误。

在 QA 中发布是很重要的，不仅是为了修复 bug，也是为了开始监控阶段。在 DevOps 中，监控对于减少和防止系统中出现错误非常重要。

监控对于检查和维护系统的稳定性非常重要。一个好的监控系统必须不仅检查系统的可用性，例如，网络是否可用或软件是否工作，而且可以用于防止未来的错误。

有很多用于监控的软件，例如 Nagios、Prometheus、Zabbix，或者 ELK 组合、Elasticsearch、Logstash 和 Kibana。所有这些软件都有其独特的优势，可以结合使用以达到最佳效果。

有效监控的一个重要原因是日志。有了好日志，就很容易启动一些日志分析策略。该策略旨在隔离常见的错误条件，并定义一些减少错误的实践，同时为开发人员提供修复软件的关键空间。

### 集中楼宇服务器

集中构建服务器对于构建正确的流水线至关重要。当我们设计 DevOps 架构时，我们必须考虑减少故障点。

当我们采用构建服务器时，我们将一切都集中在一个服务器上。这意味着我们使用不同的软件来发布我们的新软件。只有一台服务器或集群来构建新软件意味着只有一个故障点。任何问题都只集中在一点上。这降低了维护软件的成本，并加快了发布过程。

构建服务器通常与工件存储库服务器相连。存储库服务器是存储和保存构建的地方。它与持续释放有关。本质上，通过这种实践，我们每次都构建软件并将其发布到服务器。这个服务器本质上维护了我们在服务器上构建的软件的不同版本。通常，我们建立一个命名策略来维护不同的软件版本。这是因为我们希望唯一地标识软件的每个版本。

有了工件服务器，我们可以很容易地集中一个点来发布软件。通过这种方式，我们可以拥有相同软件的不同版本，并且，如果我们使用 Docker，我们可以同时在同一台服务器上拥有不同的版本。我们也可以同时启动它们，只需做一些小的调整。例如，这允许 QA 工程师进行一些回归测试，并在出现新错误的情况下，准确地识别哪个版本有缺陷。这使得开发人员能够准确地理解是什么样的代码更改引入了错误。

### 监控最佳实践

为了有效，监控必须与其他一些做法相结合。日志分析是防止错误和理解系统如何运行的最重要的实践。需要一些软件来分析日志并进行相关预测。

最常用的软件是 ELK (Elasticsearch，Logstash，和 Kibana)。这个生态系统非常有用，因为它提供了一个完整的日志分析系统，不仅提供了警报，还提供了错误和日志的图形表示。

日志分析对于提高软件质量非常重要。我们可以实施的一个重要实践是，拥有一些软件，不仅可以识别错误数量，还可以绘制这些错误。

具有错误的图形表示对于提供关于软件的可视反馈很重要，而不需要阅读日志来理解软件的状态。

监控是每个 DevOps 实践的基础，如果我们想要一个非常成功的旅程，我们必须确保有一个良好的监控系统。与此同时，我们不仅要开始监控产品，还可能要监控金丝雀服务器。这是因为它可以揭示错误，我们可以在发布到生产之前解决它。监控可以采取两种形式。*黑盒监控*测试一段代码，就好像它在黑盒里一样。它只揭示系统的状态，以确定它是否还活着。它并不能真正表明内部发生了什么，因为监控是外部的。Nagios 就是黑盒软件监控的一个例子。

与此相反的是*白盒监控* *。*这种类型的监控提供了系统内部的清晰画面，例如，打开的 HTTP 连接的数量、错误的数量等。普罗米修斯就是白盒监控软件的一个例子。

### 运营的最佳实践

在 DevOps 中，运营团队对实现最佳结果有很大的影响。运营团队的重要性与软件质量和客户对公司的看法密切相关。

如果出现错误，运营团队是公司的第一面。这个团队通常被委派在生产环境中维护软件。

与软件的唯一接触点是日志。由于这个原因，当软件被设计时，一些操作团队的成员必须被包括在内，并且，更重要的是当软件被发布用于测试时，他们可以提供反馈。这是因为如果日志不足，运营团队就无法真正识别错误，这意味着需要更多时间来解决问题。

同时，运营团队可以帮助识别常见问题，并提供文档来更快地解决这些问题。这个文档实际上是解决问题的一个步骤。它主要由一线运营工程师使用。它是“活动的”，这意味着它永远不会关闭，必须小心管理，以便与最新的软件更新保持一致。

文档必须指出日志中的常见错误，并显示如何解决问题的根本原因。该文档应由不了解该系统的人编写，基于此，必须提供关于要采取的适当步骤的具体细节。

我们可以实施的另一项运营实践是*开发人员随叫随到。*这一实践为运营界引入了一个新的形象。随叫随到的开发人员本质上是一名软件工程师，与操作专业人员一起解决生产中的错误。这有两个主要优点。首先是减少了发现和解决问题所需的时间。因为其中一个开发人员会处理这个问题，所以他/她可以很容易地识别出哪里出了问题，以及代码的哪个部分产生了这个问题。这可以推动运营团队努力修复它。

第二个好处是提高责任水平。因为开发人员致力于解决一个现存的问题，所以他/她更好地理解了软件的问题所在，从而可以改进他/她编写软件和日志的方式，因为一个糟糕的日志可能会导致他/她将来做更多的工作。

## 结论

在这一章中，我简要介绍了 devo PS——它是什么以及一项运动是如何诞生的。DevOps 对于云计算来说非常重要。云开发要求软件始终是活动的，并被设计为发布更快、质量更高。

DevOps 强调质量和上市时间。由于与持续集成和交付相关的实践有助于在系统上交付更快的服务，因此它允许简单设计的微服务架构。

DevOps 对现代软件开发非常重要，越来越多的公司开始采用它，因为它促进了一些提高软件质量所必需的最佳实践。DevOps 不仅需要改变我们对基础架构的看法，还需要改变我们设计和组织公司内部基础架构的方式。

DevOps 本质上代表了企业文化的改变。为了确保其最佳实践，改变组织是很重要的，以便其优先事项与文化变革、成功实践以及由管理驱动的变革的要求相一致，当然，这种变革是由工程师批准的。